{
  "name": "COASDASD",
  "": "",
  "query": {
    "aggs": {
      "2": {
        "terms": {
          "field": "originIp",
          "size": 10,
          "order": {
            "_count": "desc"
          }
        }
      }
    },
    "size": 0,
    "_source": {
      "excludes": []
    },
    "stored_fields": [
      "*"
    ],
    "script_fields": {},
    "docvalue_fields": [
      {
        "field": "insertedDate",
        "format": "date_time"
      },
      {
        "field": "logDate",
        "format": "date_time"
      },
      {
        "field": "normalDate",
        "format": "date_time"
      }
    ],
    "query": {
      "bool": {
        "must": [
          {
            "range": {
              "normalDate": {
                "gte": 1716918484742,
                "lte": 1717523284742,
                "format": "epoch_millis"
              }
            }
          }
        ],
        "filter": [
          {
            "bool": {
              "filter": [
                {
                  "bool": {
                    "should": [
                      {
                        "match_phrase": {
                          "entityName": "ensa ti"
                        }
                      }
                    ],
                    "minimum_should_match": 1
                  }
                },
                {
                  "bool": {
                    "filter": [
                      {
                        "bool": {
                          "should": [
                            {
                              "match_phrase": {
                                "msgClassName": "attack"
                              }
                            }
                          ],
                          "minimum_should_match": 1
                        }
                      },
                      {
                        "bool": {
                          "should": [
                            {
                              "match_phrase": {
                                "directionName": "external"
                              }
                            }
                          ],
                          "minimum_should_match": 1
                        }
                      }
                    ]
                  }
                }
              ]
            }
          },
          {
            "bool": {
              "filter": [
                {
                  "bool": {
                    "should": [
                      {
                        "match_phrase": {
                          "entityName": "ensa ti"
                        }
                      }
                    ],
                    "minimum_should_match": 1
                  }
                },
                {
                  "bool": {
                    "filter": [
                      {
                        "bool": {
                          "should": [
                            {
                              "match_phrase": {
                                "msgClassName": "attack"
                              }
                            }
                          ],
                          "minimum_should_match": 1
                        }
                      },
                      {
                        "bool": {
                          "should": [
                            {
                              "match_phrase": {
                                "directionName": "external"
                              }
                            }
                          ],
                          "minimum_should_match": 1
                        }
                      }
                    ]
                  }
                }
              ]
            }
          }
        ],
        "should": [],
        "must_not": []
      }
    }
  }
}